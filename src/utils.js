export function toCamelCase(string) {
  // arrow function uses throwaway variable for the regex match,
  // capture group 0, as per replace() format
  return string.replace(/[-_\s](.)/g, (_, char) => char.toUpperCase());
}

export function removeCamelCase(string) {
  return string.replace(/([a-z])([A-Z])/g, "$1 $2").toLowerCase();
}

export function setDateInputToday() {
  const dateInput = document.getElementById("dateInput");

  // Split at 'T' to remove time info after calendar date;
  const today = new Date().toISOString().split("T")[0];
  dateInput.value = today;
}

export function setAttributes(element, attributes) {
  Object.keys(attributes).forEach((key) =>
    element.setAttribute(key, attributes[key]),
  );
}

export function createInput(inputType, inputID, wrapperID) {
  const input = document.createElement("input");
  const label = document.createElement("label");
  const div = document.createElement("div");

  setAttributes(input, {
    type: inputType,
    name: inputID,
    id: inputID,
    value: inputID,
  });
  setAttributes(label, { for: inputID });
  setAttributes(div, { id: `${inputID}${wrapperID}` });
  label.textContent = inputID;
  div.append(label, input);

  return div;
}

export function fillDatalist(listID, obj) {
  const list = document.getElementById(listID);

  const keys = Object.keys(obj);

  for (let i = 0; i < keys.length; i += 1) {
    const option = document.createElement("option");
    option.value = removeCamelCase(keys[i]);
    list.append(option);
  }
}

export function getMovementInput() {
  const input = document.getElementById("exerciseInput");
  return input.value;
}

export function getMesocycleInput() {
  const input = document.getElementById("mesocycleInput");
  if (input.value === "other") {
    const inputOther = document.getElementById("mesocycleInputOther");
    return inputOther.value;
  }
  return input.value;
}

export function getMicrocycleInput() {
  const input = document.getElementById("microcycleInput");
  return input.value;
}

export function getWorkoutNameInput() {
  const input = document.getElementById("workoutNameInput");
  return input.value;
}

export function getWeightInput() {
  const input = document.getElementById("weight");
  return input.value;
}
export function getWeightUnit() {
  const checkedRadio = document.querySelector(
    'input[name="poundKilo"]:checked',
  );
  return checkedRadio.value;
}
export function getRepsInput() {
  const input = document.getElementById("reps");
  return input.value;
}
export function getRIRInput() {
  const input = document.getElementById("RIR");
  return input.value;
}
export function getInputValue(inputID) {
  const input = document.getElementById(inputID);
  return input.value;
}
export function getTempoValues() {
  const eccentric = document.getElementById("eccentric");
  const concentric = document.getElementById("concentric");
  return [eccentric.value, concentric.value];
}
export function getDate() {
  const datetime = document.getElementById("dateInput");
  return datetime.value;
}
export function getTimeZone() {
  return Intl.DateTimeFormat().resolvedOptions().timeZone;
}
export function getStartTime() {
  const startTime = document.getElementById("startTime");
  return startTime.value;
}

export function getEndTime() {
  const endTime = document.getElementById("endTime");
  return endTime.value;
}

export function getVariationInput() {
  const variationInputs = document.getElementById("variationInputs");
  const variations = variationInputs.childNodes;
  const variationArray = [];

  variations.forEach((variant) => {
    // children[1] accounts for the label element at the [0] spot
    if (variant.children[1].checked) {
      // console.log(variant.children[1]);
      variationArray.push(variant.children[1].value);
    }
  });
  return variationArray;
}

export function setWorkoutDateStart(obj) {
  const workoutHistoryObj = obj;
  if (workoutHistoryObj[`${getDate()}|${getStartTime()}`] === undefined) {
    workoutHistoryObj[`${getDate()}|${getStartTime()}`] = {};
    // console.log(workoutHistoryObj);
  }
}

export function setWorkoutTime(obj) {
  const workoutHistoryObj = obj;
  workoutHistoryObj.time = {
    start: getStartTime(),
    end: getEndTime(),
  };
}

export function getSetNumber() {
  const setCounter = document.getElementById("setNumber");
  const setNumber = Number(setCounter.value);
  return setNumber;
}

export function incrementSetNumber() {
  const setNumber = document.getElementById("setNumber");

  setNumber.value = Number(setNumber.value) + 1;
}

export function resetSetNumber() {
  const setNumber = document.getElementById("setNumber");
  setNumber.value = 1;
}

export function generateSetObj(obj) {
  // TODO does obj need to be defined as it is here
  const movement = getMovementInput();
  const set = getSetNumber();
  const weight = getWeightInput();
  const weightUnit = getWeightUnit();
  const reps = getRepsInput();
  const RIR = getRIRInput();
  const variationInput = getVariationInput();
  console.log(obj);

  const movementObj = obj;
  const setObj = {
    variations: {},
    weight,
    weightUnit,
    reps,
    RIR,
  };

  if (variationInput.length < 1) {
    setObj.variations.none = true;
  }
  for (let i = 0; i < variationInput.length; i += 1) {
    // TODO check this if, doesn't look needed
    if (variationInput.length < 1) console.log("none");
    setObj.variations[variationInput[i]] = true;
  }
  console.log(movementObj);
  movementObj[movement][`set${set}`] = setObj;
  // return currently not needed
  // return movementObj;
}

export function generateMovementObj() {
  const movement = getMovementInput();
  const mesocycle = getMesocycleInput();
  const microcycle = getMicrocycleInput();
  const workoutName = getWorkoutNameInput();

  const obj = {
    mesocycle,
    microcycle,
    workoutName,
    [movement]: {},
  };

  return obj;
}

// accepts an array of movement objects as a parameter
export function generateWorkoutObj(movements) {
  const obj = {};
  obj.date = getDate();

  for (let i = 0; i < movements.length; i += 1) {
    const movement = movements[i];
    obj[`exercise${i + 1}`] = movement;
  }
  return obj;
}

export function displayObject(obj) {
  const display = document.getElementById("currentWorkoutDisplay");
  const movement = Object.keys(obj);

  const p = document.createElement("p");
  // Object.keys() returns an array
  p.textContent = movement[0];
  display.append(p);
}

export function displayWorkoutInProgress(workout) {}
